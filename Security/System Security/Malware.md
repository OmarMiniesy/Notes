
### General Notes

Short for **Mal**icious Soft**ware**, and it is attacker code that is running on a victim machine.
- Software that misuses computer systems to: 
	1. Cause Denial of Service 
	2. Spy on activity
	3. Get unauthorized control

The way Malware spreads from device to another is called **propagation**.
- Different types of malware have different forms of propagation.
- Utilize **self-replicating code**, or code that can output a copy of itself to automatically spread the malware code.

---
### Virus

A virus is a form of malware that can self-propagate on user action.
- Once a virus infects a machine by changing some already present code, the malware code is stored on the machine.
- User action is then required to run that infected code to spread that virus to other machines.

> An example infection is infecting the code of an app. The user action required here is that the app be executed by the user. The code then contains strategies to propagate, such as send emails with the malicious code attached.

#### Defense Strategies

Utilize **signature-based detection**.
- Since copies are self generated replicas of each other, the code stays the same.
- This technique uses patters of known attacks and some of their bytes to create signatures for each virus.
- This signature is then used while looking inside the machine for matches to detect the presence of a virus with the same signature.

> Antivirus software use these signatures and check the machine for the presence of a list of virus by matching these signatures. The better the antivirus, the larger number of signatures it has.

#### Attacker Evasion

To evade the defense strategy that uses signature based detection, attackers need to change the appearance of the virus created so that it isn't detected.
- This process needs to be automated in the self replication step of the virus.
##### Polymorphic Code

This technique uses encryption to obfuscate the contents of the malware code, bypassing signature detection.
- The self generated copy of the virus will contain *decrypt code*, *decryption key*, and the *encrypted code*.
- The decrypt code contains the instructions to take the key and use it to decrypt the encrypted code, resulting in the original virus code.
- The [[Encryption]] schemes need to include inputs that produce different looking output with each encryption, this means using new nonces, new keys, or new Initialization Vectors.

> The goal is not to make the code private, but to make it look weird. Hence, weak encryption algorithms can be used.

To defend against this technique, it is worth noting that the decrypt code will stay the same in all the variations produced.
1. Therefore, a signature detection scheme can be added for the decrypt code itself.
	- This is hard to achieve because the decrypt code is very small to match against, and the code is scattered in the memory, making matching a hard task.
2. Another technique is take the suspected malware and run it in a sandbox to check if decryption is performed.
##### Metamorphic Code

This technique generates a semantically different version of the malware code during replication.
- Basically, the code performs the same exact functionality, but it's syntax is different.
- Therefore, there needs to be in addition to the malware code, a *rewriter code* exists. This rewriter changes the malware code, and can sometimes change the rewriter code itself.

To defend against this technique, there are multiple ways:
1. Using emulation to check if the different virus code produce the same CPU utilization and low level instructions. If they match, this means both these malware essentially do the same thing, and the suspected code is probably malware code.
2. Using behavioral detection, where the behavior of the code is analyzed, not its syntax. This produces behavioral signatures that can be used by antivirus software.
	- This technique can be easily detected by attackers and bypassed. One option is to switch to normal behavior if the malware realizes it is being tested or monitored. Another option is to add long delays before the execution of the malicious code, delaying the analysis and hence resulting in code that seems fine.

> To defend against both polymorphic and metamorphic code, a new technique emerged where unknown code is flagged. Therefore, if the code has a detectable signature it will be detected, and if the code seems unfamiliar, it will also be flagged and treated as dangerous.

---
### Worm

A worm is another form of malware that can self-propagate, but does not require user action.
- Once a worm infects a machine, it infects an already running process or code.
- This means that there is no user action needed for the worm to propagate to other devices.

Worms use several propagation strategies to infect multiple hosts. The idea here is to infect as much machines as possible quickly, hence, exponentially increasing the rate of infection. As the infected machines will also aid the workforce of infecting more machines.
- Worms can connect to random [[IP]] addresses and attempt to propagate to them.
- They can use a generated list of IP addresses and try to attack them.
- They can use google search to find victims, or even scan for targets on infected hosts.

> Once a worm infects a machine, it exploits a weakness or vulnerability that allows it to execute code, and automatically propagate itself as such.


---
### Trojan Horse

Malware that comes embedded in files, and once this file is opened, the machine is infected.
- Used to obtain [[Backdoors]] to get a shell on an infected system.

---
### Rootkit

- Malware that hides itself from users to maintain privileged access to machine.

> *Bootkit* are rootkits that wrap around OS protection mechanisms and execute during bootstrap phase. (OS loading).

---
### Bots and Botnet

Small software installed on internet connected machines to perform Denial of Service attacks.
- Controlled by a *Command and Control* server.

> Bots can be created by attackers that infect machines using malware (virus or worm) and gain unauthorized control to make it act as a bot.

A collection of these bots working together is called a **botnet**.
- This network of bots can cause *Distributed* denial of service attacks.

---
